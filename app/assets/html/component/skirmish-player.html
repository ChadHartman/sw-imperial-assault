 <div class="player">
    <canvas 
        class="skirmish-space"
        ng-repeat="uiSpace in spaces"
        style="left:{{ rCtx.left(uiSpace.space.x) }}px; top:{{ rCtx.top(uiSpace.space.y) }}px"
        width="{{ rCtx.size }}"
        height="{{ rCtx.size }}"
        ng-click="selectSpace(uiSpace)"
        data-rctx="rCtx"
        data-space="uiSpace"
        data-state="state"
        space-render></canvas>
    <div ng-repeat="unit in units">
        <!-- Grouped together for CSS selecting -->
        <canvas 
            class="skirmish-unit"
            ng-class="{ 
                exausted:unit.exausted, 
                active:unit.active, 
                active_waiting:unit.activeWaiting
            }" 
            style="left:{{ rCtx.left(unit.x) }}px; top:{{ rCtx.top(unit.y) }}px"
            width="{{ rCtx.size }}"
            height="{{ rCtx.size }}"
            data-unit="unit"
            data-targetable="isTargetable(unit)"
            data-targeted="unit === attackCtx.target"
            ng-click="selectUnit(unit)"
            unit-render></canvas>
        <div 
            class="skirmish-unit-menu" 
            style="left:{{ rCtx.left(unit.x) }}px; top:{{ rCtx.top(unit.y) }}px">
            <h1>{{ unit.deployment.title }}</h1>
            <div ng-hide="attackCtx !== null">
                <p>Actions: {{ unit.actionCount }}</p>
                <p>Movement Points: {{ unit.movementPoints }}</p>
                <ul>
                    <li ng-hide="unit.deployment.attack === null">
                        <button ng-click="attack(unit)">Attack</button>
                    </li>
                    <li ng-hide="unit.deployment.speed === 0">
                        <button ng-click="move(unit)">Move</button>
                    </li>
                </ul>
                <button ng-click="exaust(unit)">Exaust</button>
            </div>
            <div ng-show="attackCtx.target === null">
                <p>Select Target</p>
                <button ng-click="cancelAttack()">Cancel</button>
            </div>
        </div>
    </div>
    <div
        id="attack-menu"
        ng-show="attackMenuVisible()">
        <!-- Surg spend screen -->
        <p>Target: {{ attackCtx.target.deployment.title }}</p>
        <div>
            <img
                class="die" 
                ng-repeat="roll in attackCtx.attackRoll"
                ng-click="rerollAttackDie(roll)" 
                
                data-lazy-src="assets/png/dice/{{ roll.die.name }}.{{ roll.side.index }}.png"/>
        </div>
        <div>
            <img 
                class="die"
                ng-click="rerollDefenseDie(roll)" 
                ng-repeat="roll in attackCtx.defenseRoll" 
                data-lazy-src="assets/png/dice/{{ roll.die.name }}.{{ roll.side.index }}.png"/>
        </div>
        <p>Damage: {{ attackCtx.damage }}, Surges: {{ attackCtx.surge }}</p>
        <ul>
            <li ng-repeat="surge in attackCtx.attacker.deployment.surges">
                <button
                    class="surge"
                    ng-disabled="surge.cost > attackCtx.surge"
                    ng-click="spendSurge(surge)"
                    ng-disabled="attackCtx.isSurgeSpent(surge)"
                    symbolize="surge.toString()">
                </button>
            </li>
        </ul>
    </div>
</div>